---
title: "PS811 Portfolio"
author: "Monica Komer"
output:
  html_document: 
    toc: true ## table of contents
    code_folding: hide
---
```{r setup, include=FALSE}
## Defaults for R chunks
knitr::opts_chunk$set(echo = TRUE, ## echo = TRUE means code will show
                      warning=FALSE, ## supress warnings and messages from R
                      message=FALSE,
                      fig.path='Figs/', ## where to save figures
                      fig.height = 3, ## default figure size (can differ in each chunk)
                      fig.width = 3)

## Add any R packages you require. 
## Here are some we will use in 811:
requires <- c("tidyverse", ## tidyverse includes dplyr and ggplot2
              "magrittr",
              "foreign",
              "readstata13",
              "here")

## Install any you don't have
to_install <- c(requires %in% rownames(installed.packages()) == FALSE)
install.packages(c(requires[to_install], "NA"), repos = "https://cloud.r-project.org/" )

## Load all required R packages
library(tidyverse)
library(ggplot2); theme_set(theme_minimal())
library(magrittr)
library(here)
```



### Research Interests
The overarching focus of my research is on the causes and consequences of women’s representation with a particular focus on the Middle East and North Africa. More specifically, I am interested in studying how (and which) women gain leadership positions in political parties and the effect of women’s presence on citizen’s attitudes and behaviors. 

### Questions I hope to answer
Which women gain leadership positions in secular and religious parties? What determines which women run, where (i.e. district location) they run, and their position on party lists?

Do female politicians interact with constituents differently than their male colleagues? Is this conditional on party affiliation or quota type? Are citizens more loyal to regimes that enact gender quotas? Are women more interested in politics when represented by a woman instead of a male?

---

### Methods
Various regression models including hierarchical models, survey experiments, text analysis, and qualitative methods (primarily interviews and focus groups). 

---

### Relevent data

- Arab Barometer ( [data](http://www.arabbarometer.org/survey-data/) )

- World Values Survey ( [data](http://www.worldvaluessurvey.org/WVSContents.jsp) )

- Afro Barometer ( [data](http://www.afrobarometer.org/data) )

- Quota Adoption and Reform over Time (QAROT) dataset ( [data](https://www.openicpsr.org/openicpsr/project/100918/version/V1/view) )

- Tunisia Election Data (results by district available [here](http://tunisiaelectiondata.com/) )


---

### Something cool

Using Arab Barometer data to evaluate attitudes towards female leaders. In particular, I evaluate respondent's attitudes regarding whether "men are better at political leadership than women":

```{r ABIV_data}
#loading data
d <- read.csv(here("data/ABIV_English_subset.csv"))

#naming things and recoding leader variable (so higher values indicate more gender egalitarian views)
d$leader <- as.numeric(d$q6013)
d$leader[as.numeric(d$q6013) == 3] <- 2
d$leader[as.numeric(d$q6013) == 4] <- 3
d$leader[as.numeric(d$q6013) == 5] <- 1
d$leader[as.numeric(d$q6013) == 6] <- 4
d$leader[as.numeric(d$q6013) < 3] <- NA

# a little shorter with dplyr
d$leader %<>% 
  recode(`3` = 2,
         `4` = 3,
         `5` = 1,
         `6` = 4,
         .default = NaN) # numeric double so NaN, if character this would be NA


d$female <- as.numeric(d$q1002)

d$female[as.numeric(d$q1002) == 2] <- 0

# or with dplyr:
d$female %<>% recode(`1` = 1, `2`= 0)

d$female <- as.factor(d$female) 
# Unless you really like working with factors, you could probably skip this by importing with strings.as.factors = FALSE, and let R coerce to factor only need needed.

#age by category
d$age_cat <- as.numeric(d$q1001)
d$age_cat[as.numeric(d$q1001) == 74] <- NA
d$age_cat[as.numeric(d$q1001) < 8] <- 1
d$age_cat[as.numeric(d$q1001) > 7 & as.numeric(d$q1001) < 18] <- 2
d$age_cat[as.numeric(d$q1001) > 17 & as.numeric(d$q1001) < 28] <- 3
d$age_cat[as.numeric(d$q1001) > 27 & as.numeric(d$q1001) < 38] <- 4
d$age_cat[as.numeric(d$q1001) > 37 & as.numeric(d$q1001) < 48] <- 5
d$age_cat[as.numeric(d$q1001) > 47 & as.numeric(d$q1001) < 74] <- 6

# this could also be done with mutate(age_cat = ifelse()) or case_when()
# more importanly, why not make these strings? "<8" "8-27" etc.
# If you are using it as an ordered variable in a model, I understand, but you may want a discriptive one for figures and discriptive stats. The results of summarize below would be more clear and will be easier to plot if you just use text labels (gender was already labeled, just being imported as a factor)
```

```{r additional vars, include=FALSE}
d %<>%
  group_by(female) %>% 
  mutate(leader_meanf = mean(leader, na.rm = TRUE))

head(d$leader_meanf) # notice how there are only 2 values
```
<!-- Unclear what I'm doing wrong in the chunk of code above. Trying to make a var that is the mean response by gender. -->

<!-- The pipe was only going one way %>%, so it was failing to alter d. You wanted not just to pipe d into those functions, but also redefine d as the resullt, i.e.  d %<>%, which is equivilant to d <- d %>%

However, this variable only has two values (only two genders represented in theses data), so it may not be worth it in this case.
Glad you left a note! 
-->

The mean level of support among women is `r round(mean(d$leader[d$female==1], na.rm = T),2 )`, and among men it is `r round( mean(d$leader[d$female==0], na.rm = T),2 )`.

Mean response by gender and age with higher values indicating more gender egalitarian views (i.e., less supportive of the statement that "men are better at political leadership than women"):
```{r means}

#Mean response by gender
d %>%
  group_by(female) %>% summarise(leader = mean(leader, na.rm=TRUE))

# Without recoding the gender variable
d %>%
  group_by(q1002) %>% summarise(leader = mean(leader, na.rm=TRUE))


#Mean response by age
d %>%
  group_by(age_cat) %>% summarise(leader = mean(leader, na.rm=TRUE))

```

```{r age-histogram, fig.width=8}
# Obviously this could benifit from better names and labels, but maybe you'll find it useful.
d %>% 
  mutate(age = as.numeric(q1001),
         gender = q1002) %>% 
  mutate(agree = ifelse(str_detect(q6013," agree"), "Agree", NA)) %>%
  mutate(agree = ifelse(str_detect(q6013,"disagree"), "Disagree", agree)) %>%
  filter(!is.na(agree) ) %>%
  ggplot() +
  aes(x = age, fill = q6013) +
  geom_histogram(binwidth = 10) + facet_grid(gender ~ agree)
```


