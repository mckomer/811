---
title: "PS811 Portfolio"
author: "Monica Komer"
output:
  html_document: 
    toc: true ## table of contents
    code_folding: hide
---
```{r setup, include=FALSE}
## Defaults for R chunks
knitr::opts_chunk$set(echo = TRUE, ## echo = TRUE means code will show
                      warning=FALSE, ## supress warnings and messages from R
                      message=FALSE,
                      fig.path='Figs/', ## where to save figures
                      fig.height = 3, ## default figure size (can differ in each chunk)
                      fig.width = 3)

## Add any R packages you require. 
## Here are some we will use in 811:
requires <- c("tidyverse", ## tidyverse includes dplyr and ggplot2
              "magrittr",
              "foreign",
              "readstata13",
              "here")

## Install any you don't have
to_install <- c(requires %in% rownames(installed.packages()) == FALSE)
install.packages(c(requires[to_install], "NA"), repos = "https://cloud.r-project.org/" )

## Load all required R packages
library(tidyverse)
library(ggplot2); theme_set(theme_minimal())
library(magrittr)
library(here)
library(dplyr)
```



### Research Interests
The overarching focus of my research is on the causes and consequences of women’s representation with a particular focus on the Middle East and North Africa. More specifically, I am interested in studying how (and which) women gain leadership positions in political parties and the effect of women’s presence on citizen’s attitudes and behaviors. 

### Questions I hope to answer
Which women gain leadership positions in secular and religious parties? What determines which women run, where (i.e. district location) they run, and their position on party lists?

Do female politicians interact with constituents differently than their male colleagues? Is this conditional on party affiliation or quota type? Are citizens more loyal to regimes that enact gender quotas? Are women more interested in politics when represented by a woman instead of a male?

---

### Methods
Various regression models including hierarchical models, survey experiments, text analysis, and qualitative methods (primarily interviews and focus groups). 

---

### Relevent data

- Arab Barometer ( [data](http://www.arabbarometer.org/survey-data/) )

- World Values Survey ( [data](http://www.worldvaluessurvey.org/WVSContents.jsp) )

- Afro Barometer ( [data](http://www.afrobarometer.org/data) )

- Quota Adoption and Reform over Time (QAROT) dataset ( [data](https://www.openicpsr.org/openicpsr/project/100918/version/V1/view) )

- Tunisia Election Data (results by district available [here](http://tunisiaelectiondata.com/) )


---

### Something cool

Using Arab Barometer data to evaluate attitudes towards female leaders. In particular, I evaluate respondent's attitudes regarding whether "men are better at political leadership than women":

```{r ABIV_data}
#loading data
d <- read.csv(here("data/ABIV_English_subset.csv"))

#naming things and recoding leader variable (so higher values indicate more gender egalitarian views)
d$leader <- as.numeric(d$q6013)
d$leader[as.numeric(d$q6013) == 3] <- 2
d$leader[as.numeric(d$q6013) == 4] <- 3
d$leader[as.numeric(d$q6013) == 5] <- 1
d$leader[as.numeric(d$q6013) == 6] <- 4
d$leader[as.numeric(d$q6013) < 3] <- NA


d$female <- as.numeric(d$q1002)
d$female[as.numeric(d$q1002) == 2] <- 0



```
<!-- When I run the code you recommended: d$leader %<>% 
  recode(`3` = 2,
         `4` = 3,
         `5` = 1,
         `6` = 4,
         .default = NaN) 
or 
d$female %<>% recode(`1` = 1, `2`= 0)
I get an error: "No applicable method for 'recode' applied to an object of class "NULL".-->


Mean response by gender and country with higher values indicating more gender egalitarian views (i.e., less supportive of the statement that "men are better at political leadership than women"):
```{r means}

#Mean response by gender
d %>%
  group_by(female) %>% summarise(leader = mean(leader, na.rm=TRUE))



#Mean response by country
d %>%
  group_by(country) %>% summarise(leader = mean(leader, na.rm=TRUE))

```

Plotting responses by age and gender: 
```{r age-histogram, fig.width=8}
# Obviously this could benifit from better names and labels, but maybe you'll find it useful.
d %>% 
  mutate(age = as.numeric(q1001),
         gender = q1002) %>% 
  mutate(agree = ifelse(str_detect(q6013,"agree"), "Agree", NA)) %>%
  mutate(agree = ifelse(str_detect(q6013, "disagree"), "Disagree", agree)) %>%
  filter(!is.na(agree) ) %>%
  ggplot() +
  aes(x = age, fill = q6013) +
  labs(x= "Age", y = "Number of Respondents", fill = "Response") +
  geom_histogram(binwidth = 10) + facet_grid(gender ~ agree)
```


It may also be useful to compare countries. Here is a bar plot representing the mean response by country (with larger values indicating more gender egalitarian attitudes).

```{r Country-Bar, fig.width=8}
d %>%
  group_by(country) %>%
  mutate(leader_m = mean(leader, na.rm= TRUE)) %>%
  distinct(country, leader_m) %>%
  ggplot() + 
  aes(x = reorder(country, leader_m), y = leader_m) +
  labs(x= "Country", y="Mean Response") +
  geom_bar(stat= "identity")
```


We can also visualize the mean response by gender and country:
```{r Country and Gender-Bar, fig.width=8}
d %>%
  mutate(gender = q1002) %>%
  group_by(country, gender) %>%
  mutate(leader_m = mean(leader, na.rm= TRUE)) %>%
  distinct(country, leader_m) %>%
  ggplot() + 
  aes(x = reorder(country, leader_m), y = leader_m, fill = gender) +
  labs(x= "Country", y="Mean Response") +
  geom_bar(stat= "identity")
```


An alternative, and somewhat easier, way to visualize the gender gap in attitudes towards female leaders:
```{r Gender Gap-plot, fig.width=8}

d %>%
  mutate(gender = q1002) %>%
  group_by(country, gender) %>%
  mutate(leader_m = mean(leader, na.rm= TRUE)) %>%
  distinct(country, leader_m) %>%
  ggplot() +
  geom_point() +
  aes(y = reorder(country, leader_m), x = leader_m, color = gender) +
  labs(y= "Country", x="Mean Response\n(Least to Most Supportive)", title= " Gender Gap in Attitudes Towards Female Leaders")
```
<!-- Devin, in the chunk above, I tried to put "Least Supportive" and "Most Supportive" under the min and max points under the x axis, but ran into trouble. Is there an easy way to do this? Also in the chunk below, I got an error when I tried to add a distance line.-->



```{r CountryGender Gap-plot, fig.width=8, eval= FALSE}
d %>%
  mutate(gender = q1002) %>%
  group_by(country, gender) %>%
  mutate(leader_m = mean(leader, na.rm= TRUE)) %>%
  distinct(country, leader_m) %>%
  ggplot() + 
  geom_point() +
  aes(y = reorder(country, leader_m), x = leader_m, color = gender) +
  labs(y= "Country", x="Mean Response") +
  geom_segment(aes(x = min, 
                   xend = max, 
                   y = country
                   yend = country) )
```
<!-- Devin, in the chunk above, I'm trying to add a distance line (from Male to Female) for each country. I'm running into an error when I include the geom_segment() code.-->





